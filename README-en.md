# Kindle Dashboard

[‰∏≠Êñá](README.md)

A simple KUAL extension that turns your jailbroken Kindle into a low-power e-ink dashboard. It periodically downloads an image from a specified URL and displays it on the screen.

![Real Shot](demo_shot.avif)

## ‚ú® Features

*   **Exclusive Mode**: Automatically stops the native Kindle Framework to prevent interface interference or sleep mode, taking full control of the screen.
*   **Auto Connectivity**: Forces WiFi to wake up before each update to ensure successful image downloads.
*   **Scheduled Refresh**: Configurable refresh interval (default is 1 hour).
*   **High-Quality Rendering**: Integrates [FBInk](https://github.com/NiLuJe/FBInk) supporting high-quality waveform refresh (GC16) to minimize ghosting.
*   **Error Handling**: Displays an onscreen error message if the network request fails, rather than staying black or freezing.
*   **Local Clock Overlay**: Overlays the current time on top of the image, updating every minute with a partial refresh (no WiFi needed).
*   **Smart Sleep**: Automatically aligns with the system clock to wake up exactly at the 00th second of every minute, maximizing battery life.
*   **Image Processing Tool**: Includes a Python script to convert standard images into 16-level grayscale dithered images optimized for Kindle displays.

## üñ•Ô∏è Server Companion

To unlock the full potential of this extension, it is highly recommended to use it with the dedicated **Kindle Dashboard Server**:

*   **Repository**: [https://github.com/t0saki/Kindle-Dashboard-Server](https://github.com/t0saki/Kindle-Dashboard-Server)
*   **Features**:
    *   **Optimized for Kindle**: Renders 1680x1264 high-res, 16-level grayscale dithered images perfect for E-ink screens.
    *   **Rich Data**: Integrates weather, AQI, calendar, stocks/crypto trends, Hacker News, and more.
    *   **Highly Customizable**: Supports multi-language, global weather, and custom layouts.
    *   **Easy Deployment**: Supports one-click Docker deployment.

## üõ†Ô∏è Prerequisites

1.  **Jailbroken Kindle**.
2.  **KUAL** (Kindle Unified Application Launcher) installed.

## üì• Installation

1.  Copy the `extensions` folder from this project to the root directory of your Kindle.
    *   Merge folders if prompted.
    *   The final path structure should be: `Kindle_Root_Drive/extensions/Kindle-Dashboard/...`
2.  Eject/Disconnect the USB cable.

## ‚öôÔ∏è Configuration

The default configuration is located in `extensions/Kindle-Dashboard/bin/run_daemon.sh`. You need to modify the following variables:

```bash
# Image URL (Change this to your actual server address)
IMG_URL="https://your-server.com/dashboard.png"

# Image Refresh Interval (seconds)
INTERVAL=300

# Full Refresh Cycle (Perform a full refresh after every N partial refreshes to clear ghosting)
FULL_REFRESH_CYCLE=12

# Screen Rotation (0=0¬∞, 1=90¬∞, 2=180¬∞, 3=270¬∞)
ROTATE=3

# =============== Local Clock Configuration ===============
# Enable Local Clock (1=Enable, 0=Disable)
ENABLE_LOCAL_CLOCK=1

# Clock Position (Coordinates depend on your screen orientation and resolution)
CLOCK_X=300
CLOCK_Y=100
CLOCK_SIZE=80

# Font Path (Optional, leave empty to use fbink default font)
# CLOCK_FONT="${BASE_DIR}/IBMPlexMono-SemiBold.ttf"
```

**Tip**: Ensure the image generated by your server matches your Kindle's screen resolution (e.g., 1264x1680 for Kindle Oasis 2/3) for the best display results.

## üöÄ Usage

1.  Open **KUAL** on your Kindle.
2.  Tap on the **Kindle-Dashboard** menu.
3.  Tap **Start Dashboard (No GUI)**.
4.  The native Kindle interface will disappear, and the screen will start refreshing with your dashboard image.

> **‚ö†Ô∏è Note**: During startup, the screen may flash multiple times, and you might see some temporary error messages (the script is cleaning up background processes). This is normal behavior. Please wait for about **1 minute** for the service to fully start.

**Verified Device**: This project has been tested on **Kindle Oasis 2** and **Kindle Paperwhite 3**. Please note that **Kindle Paperwhite 3** has different rotation parameters, 2 is landscape.

**How to Exit?**
Since the script kills the native Framework (`stop framework`), you need to **long-press the Kindle power button** to restart the device and restore normal reading mode.

## üñºÔ∏è Image Conversion Tool

To achieve the best display quality on E-Ink screens (avoiding severe banding), it is recommended to use the provided `convert_kindle_image.py` script to process your images.

This script automatically:
1.  Resizes the image to target resolution (default 1264x1680).
2.  Converts distinct colors to 16-level grayscale.
3.  Applies Floyd-Steinberg dithering.

**Install Dependencies:**
```bash
pip install pillow
```

**Usage:**
```bash
python convert_kindle_image.py your_image.png
# Output file will be named: your_image_k_fixed.png
```

## üìú Credits & Acknowledgments

*   **FBInk**: This project uses the `FBInk` tool for screen refreshing.
    *   File path: `extensions/Kindle-Dashboard/bin/fbink`
    *   This binary is compiled from: [https://github.com/NiLuJe/FBInk](https://github.com/NiLuJe/FBInk)
    *   Special thanks to **NiLuJe** for developing this powerful E-Ink screen control library.

## ‚ö†Ô∏è Disclaimer

This project requires a jailbroken device and modifies system processes. While generally safe, please modify your system at your own risk. The author is not responsible for any device damage.

## üìÑ License

This project is licensed under the MIT License. The license of FBInk is please refer to [FBInk](https://github.com/NiLuJe/FBInk).
